{"paragraphs":[{"text":"%md # Creating our `calls` and `cells` Dataframe\n\nThis script is our main entry point into processing our CDR data. If we were to execute this script on a large set of CDRs records, ths is likely be the most time intensive instruction, assumming the core transformation is geared towards just reading in data. The time will vary as to the type of records we are reading in. If you are running Spark on your own on-premises Hadoop cluster that as a function of network locality, the latency usually incurred when using Cloud hosted backends are mitigating. However, depending on how large the data are and the function of the queries overhead will be a function of network shuffling.\n\nThe rest of our process scripts either rely explictly on the `calls` and `cells` Dataframes or they rely on the temporary view that is created to support SQL-like queries of our data. Below, we draft the code that will read our CDRs and tower dataset and carry some basic manipulations. ","user":"innocent","dateUpdated":"2021-01-20T23:24:12+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Creating our <code>calls</code> and <code>cells</code> Dataframe</h1>\n<p>This script is our main entry point into processing our CDR data. If we were to execute this script on a large set of CDRs records, ths is likely be the most time intensive instruction, assumming the core transformation is geared towards just reading in data. The time will vary as to the type of records we are reading in. If you are running Spark on your own on-premises Hadoop cluster that as a function of network locality, the latency usually incurred when using Cloud hosted backends are mitigating. However, depending on how large the data are and the function of the queries overhead will be a function of network shuffling.</p>\n<p>The rest of our process scripts either rely explictly on the <code>calls</code> and <code>cells</code> Dataframes or they rely on the temporary view that is created to support SQL-like queries of our data. Below, we draft the code that will read our CDRs and tower dataset and carry some basic manipulations.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1611185052888_-893114775","id":"20201203-191609_594414258","dateCreated":"2021-01-20T23:24:12+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:60"},{"text":"%md ## A. Setting up our environment\nBefore we get started, there is something to remember about how `Zeppelin` evaluate the commands in our cells. In each cell there is some bit of text following the `%` character. This is can be thought of like pre-processor directives in languages like C++ (#) which are use to set some configuration or macro before some code is executed. In `Zeppelin` it informs Zeppelin whcih interpreter to use to evaluate the contents of the cell. For the purpose of this training, we write and evaluate our code in Python. When we write raw python code we use the follow directive: `%python`. However, when we want to make sure to Zeppelin's pyspark kernel we need to use `%spark.pysaprk`. If we dont include this, then `Zeppeli`n will not know to use Spark. This entire script relies on Spark so we will use `%spark.pysaprk` before the code we write.\n\nFinally, Apache Zeppelin allows us to skip some configuration details that we might have to set manually, if we were running Spark without it. The most important is that we do not need to create a `SparkSession` and the `SparkSQlContext`. When we run out first cell with the `spark.pyspark` directive, Zepellin creates the session and context for us and store it in a variable called `spark`. We use this variable below to gain access to Spark's `read` method.","user":"innocent","dateUpdated":"2021-01-20T23:24:12+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>A. Setting up our environment</h2>\n<p>Before we get started, there is something to remember about how <code>Zeppelin</code> evaluate the commands in our cells. In each cell there is some bit of text following the <code>%</code> character. This is can be thought of like pre-processor directives in languages like C++ (#) which are use to set some configuration or macro before some code is executed. In <code>Zeppelin</code> it informs Zeppelin whcih interpreter to use to evaluate the contents of the cell. For the purpose of this training, we write and evaluate our code in Python. When we write raw python code we use the follow directive: <code>%python</code>. However, when we want to make sure to Zeppelin&rsquo;s pyspark kernel we need to use <code>%spark.pysaprk</code>. If we dont include this, then <code>Zeppeli</code>n will not know to use Spark. This entire script relies on Spark so we will use <code>%spark.pysaprk</code> before the code we write.</p>\n<p>Finally, Apache Zeppelin allows us to skip some configuration details that we might have to set manually, if we were running Spark without it. The most important is that we do not need to create a <code>SparkSession</code> and the <code>SparkSQlContext</code>. When we run out first cell with the <code>spark.pyspark</code> directive, Zepellin creates the session and context for us and store it in a variable called <code>spark</code>. We use this variable below to gain access to Spark&rsquo;s <code>read</code> method.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1611185052889_841350182","id":"20201203-192214_1566480115","dateCreated":"2021-01-20T23:24:12+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:61"},{"text":"%spark.pyspark\n# 1. First import the libraries we need to use Spark internal features \nfrom pyspark.sql.functions import split, lit, window, concat, unix_timestamp, to_timestamp, date_format, col, lit, to_date, substring\nfrom pyspark.sql.types import StructType, StructField, StringType, IntegerType\nfrom pyspark import StorageLevel","user":"innocent","dateUpdated":"2021-01-20T23:39:19+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1611185052890_357214169","id":"20201202-233828_572345964","dateCreated":"2021-01-20T23:24:12+0000","dateStarted":"2021-01-20T23:39:19+0000","dateFinished":"2021-01-20T23:39:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62"},{"text":"%spark.pyspark\n#2. These are variable that we need to execute the script. Please be sure to replace the empty string with the correct path. If you have pull the files from github locally. How can you use a Zeppelin shell to find the path to the directory you care about? \npath_to_cdrs = \"s3n://sierra-leone-lake/training/data/cdrs/mock_data.csv\"\npath_to_towers = \"s3n://sierra-leone-lake/training/data/towers/towers.csv\"\ncutoff =  15","user":"innocent","dateUpdated":"2021-01-20T23:39:33+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1611185052890_-443222000","id":"20201202-234027_1490499196","dateCreated":"2021-01-20T23:24:12+0000","dateStarted":"2021-01-20T23:39:33+0000","dateFinished":"2021-01-20T23:39:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:63"},{"text":"%spark.pyspark\n\"3/8/20 3:15\"","user":"innocent","dateUpdated":"2021-01-21T12:53:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611233611110_22224788","id":"20210121-125331_2100538985","dateCreated":"2021-01-21T12:53:31+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:64"},{"text":"%spark.pyspark\ndate_format = \"MM/dd/yy H:m\"\n\ncalls = spark.read.format(\"csv\")\\\n    .option(\"header\",\"true\")\\\n    .option(\"inferSchema\", \"true\")\\\n    .load(path_to_cdrs)\\\n    .withColumnRenamed(\"_c5\", \"antenna_id\")\\\n    .withColumnRenamed(\"_c2\", \"time\")\\\n    .withColumnRenamed(\"_c4\", \"direction\")\\\n    .withColumnRenamed(\"_c0\", \"source\")\\\n    .withColumn(\"msisdn\", F.col(\"source\"))\\\n    .withColumnRenamed(\"_c1\", \"target\")\\\n    .withColumnRenamed(\"_c3\", \"duration\")\\\n    .withColumn(\"site_id\", substring(F.col(\"antenna_id\"), 0, 4))\n\ncalls = calls.withColumn(\"call_datetime\", to_timestamp(F.col(\"time\"), date_format))\\\n    .withColumn(\"call_date\", to_date(F.col(\"call_datetime\")))\\\n    .withColumn(\"end_time\",  to_timestamp(unix_timestamp(F.col(\"call_datetime\")) + F.col(\"duration\")))\n    \n\ncalls.persist(StorageLevel.MEMORY_AND_DISK)\ncalls.createOrReplaceTempView(\"calls\")\n","user":"innocent","dateUpdated":"2021-01-20T23:39:39+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1611185052891_1288825060","id":"20201202-234009_367603988","dateCreated":"2021-01-20T23:24:12+0000","dateStarted":"2021-01-20T23:39:39+0000","dateFinished":"2021-01-20T23:39:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:65"},{"text":"%spark.pyspark\n","user":"ajalloh","dateUpdated":"2021-01-21T13:04:19+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611234259236_30428287","id":"20210121-130419_1512361367","dateCreated":"2021-01-21T13:04:19+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:66"},{"text":"%spark.pyspark\ncalls.show()","user":"innocent","dateUpdated":"2021-01-20T23:24:12+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+------------+--------+-------------+----------+--------------------+-------+-------------------+----------+-------------------+\n|              source|              target|        time|duration|    direction|antenna_id|              msisdn|site_id|      call_datetime| call_date|           end_time|\n+--------------------+--------------------+------------+--------+-------------+----------+--------------------+-------+-------------------+----------+-------------------+\n|FFFFEA4B48999C2AA...|FFD72EBE78224972D...|3/4/20 20:15|      24| Incoming SMS|     35317|FFFFEA4B48999C2AA...|   3531|2020-03-04 20:15:00|2020-03-04|2020-03-04 20:15:24|\n|D4B16F8B309644092...|C106CDB335A40A7AD...| 3/5/20 1:15|     213|Incoming call|     22062|D4B16F8B309644092...|   2206|2020-03-05 01:15:00|2020-03-05|2020-03-05 01:18:33|\n|1E08D3411156B72E1...|C911F982B7E2C22CD...| 3/5/20 2:15|       0| Incoming SMS|     22062|1E08D3411156B72E1...|   2206|2020-03-05 02:15:00|2020-03-05|2020-03-05 02:15:00|\n|5B7E909F73FC7372F...|A0DEA0DBF1F5C5333...| 3/5/20 3:15|       1|Incoming call|     20221|5B7E909F73FC7372F...|   2022|2020-03-05 03:15:00|2020-03-05|2020-03-05 03:15:01|\n|CCFF38935CBF45B37...|F4B513EF01BF8A638...| 3/5/20 4:15|      24|Outgoing call|     20226|CCFF38935CBF45B37...|   2022|2020-03-05 04:15:00|2020-03-05|2020-03-05 04:15:24|\n|E2AB34F8BB420D35F...|BD520C48A34BA201D...| 3/5/20 5:15|       9|Outgoing call|     20981|E2AB34F8BB420D35F...|   2098|2020-03-05 05:15:00|2020-03-05|2020-03-05 05:15:09|\n|DE9780FC7BD8DF0F5...|F616464F1DC48CA56...| 3/5/20 6:15|      57|Incoming call|     10212|DE9780FC7BD8DF0F5...|   1021|2020-03-05 06:15:00|2020-03-05|2020-03-05 06:15:57|\n|09D7B89E5590E2576...|F475AA91F486EA5CD...| 3/5/20 7:15|       0| Incoming SMS|     10261|09D7B89E5590E2576...|   1026|2020-03-05 07:15:00|2020-03-05|2020-03-05 07:15:00|\n|A43CF21B5F99731F2...|BB7B2AB9EB330C1EB...| 3/5/20 8:15|      63|Outgoing call|     20358|A43CF21B5F99731F2...|   2035|2020-03-05 08:15:00|2020-03-05|2020-03-05 08:16:03|\n|255AD6FD7E2001125...|5CCE981FAA2A4150B...| 3/5/20 9:15|      24|Incoming call|     20364|255AD6FD7E2001125...|   2036|2020-03-05 09:15:00|2020-03-05|2020-03-05 09:15:24|\n|DCCB83A592032E252...|08F092D5F3DCE7E54...|3/5/20 10:15|      61|Outgoing call|     20151|DCCB83A592032E252...|   2015|2020-03-05 10:15:00|2020-03-05|2020-03-05 10:16:01|\n|CD95FCA06EAB79DDE...|6F67A423DFBED461C...|3/5/20 11:15|       1|Outgoing call|     20151|CD95FCA06EAB79DDE...|   2015|2020-03-05 11:15:00|2020-03-05|2020-03-05 11:15:01|\n|CD95FCA06EAB79DDE...|C97E3373F4FCAE951...|3/5/20 12:15|      52|Incoming call|     36056|CD95FCA06EAB79DDE...|   3605|2020-03-05 12:15:00|2020-03-05|2020-03-05 12:15:52|\n|B862EE3D2E3116313...|12D44BBA7C601F8EF...|3/5/20 13:15|       0| Incoming SMS|     36056|B862EE3D2E3116313...|   3605|2020-03-05 13:15:00|2020-03-05|2020-03-05 13:15:00|\n|DD8FBDA5A3514235E...|AC30D97C9C2131D1C...|3/5/20 14:15|       0| Incoming SMS|     34607|DD8FBDA5A3514235E...|   3460|2020-03-05 14:15:00|2020-03-05|2020-03-05 14:15:00|\n|C3D81710BA15B496C...|80FE622150D7A73D6...|3/5/20 15:15|     156|Incoming call|     34605|C3D81710BA15B496C...|   3460|2020-03-05 15:15:00|2020-03-05|2020-03-05 15:17:36|\n|09A77B4A47392F1ED...|2C0EAB16D40BEC95D...|3/5/20 16:15|      44|Incoming call|     20357|09A77B4A47392F1ED...|   2035|2020-03-05 16:15:00|2020-03-05|2020-03-05 16:15:44|\n|120C6EB13C98E4A4E...|AAC86FE84600BAAE1...|3/5/20 17:15|       4|Outgoing call|     20357|120C6EB13C98E4A4E...|   2035|2020-03-05 17:15:00|2020-03-05|2020-03-05 17:15:04|\n|9909348E58D954C71...|0C69C8909C9FB1E15...|3/5/20 18:15|       9|Outgoing call|     10212|9909348E58D954C71...|   1021|2020-03-05 18:15:00|2020-03-05|2020-03-05 18:15:09|\n|5540EDDBBD19DF48F...|4F753F20CC76DE33D...|3/5/20 19:15|      33|Outgoing call|     10212|5540EDDBBD19DF48F...|   1021|2020-03-05 19:15:00|2020-03-05|2020-03-05 19:15:33|\n+--------------------+--------------------+------------+--------+-------------+----------+--------------------+-------+-------------------+----------+-------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1611185052891_-1486982235","id":"20210120-200321_1850498000","dateCreated":"2021-01-20T23:24:12+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:67"},{"text":"%spark.pyspark\ncells = spark.read.format(\"csv\")\\\n  .option(\"header\", \"true\")\\\n  .option(\"inferSchema\", \"true\")\\\n  .load(path_to_towers)\\\n \ncells.persist(StorageLevel.MEMORY_AND_DISK)\ncells.createOrReplaceTempView(\"cells\")","user":"innocent","dateUpdated":"2021-01-20T23:39:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1611185052891_-269805868","id":"20201202-234231_890993331","dateCreated":"2021-01-20T23:24:12+0000","dateStarted":"2021-01-20T23:39:55+0000","dateFinished":"2021-01-20T23:39:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:68"},{"text":"%spark.pyspark\ncalls.show()","user":"innocent","dateUpdated":"2021-01-20T23:24:12+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+------------+--------+-------------+----------+--------------------+-------+-------------------+----------+-------------------+\n|              source|              target|        time|duration|    direction|antenna_id|              msisdn|site_id|      call_datetime| call_date|           end_time|\n+--------------------+--------------------+------------+--------+-------------+----------+--------------------+-------+-------------------+----------+-------------------+\n|FFFFEA4B48999C2AA...|FFD72EBE78224972D...|3/4/20 20:15|      24| Incoming SMS|     35317|FFFFEA4B48999C2AA...|   3531|2020-03-04 20:15:00|2020-03-04|2020-03-04 20:15:24|\n|D4B16F8B309644092...|C106CDB335A40A7AD...| 3/5/20 1:15|     213|Incoming call|     22062|D4B16F8B309644092...|   2206|2020-03-05 01:15:00|2020-03-05|2020-03-05 01:18:33|\n|1E08D3411156B72E1...|C911F982B7E2C22CD...| 3/5/20 2:15|       0| Incoming SMS|     22062|1E08D3411156B72E1...|   2206|2020-03-05 02:15:00|2020-03-05|2020-03-05 02:15:00|\n|5B7E909F73FC7372F...|A0DEA0DBF1F5C5333...| 3/5/20 3:15|       1|Incoming call|     20221|5B7E909F73FC7372F...|   2022|2020-03-05 03:15:00|2020-03-05|2020-03-05 03:15:01|\n|CCFF38935CBF45B37...|F4B513EF01BF8A638...| 3/5/20 4:15|      24|Outgoing call|     20226|CCFF38935CBF45B37...|   2022|2020-03-05 04:15:00|2020-03-05|2020-03-05 04:15:24|\n|E2AB34F8BB420D35F...|BD520C48A34BA201D...| 3/5/20 5:15|       9|Outgoing call|     20981|E2AB34F8BB420D35F...|   2098|2020-03-05 05:15:00|2020-03-05|2020-03-05 05:15:09|\n|DE9780FC7BD8DF0F5...|F616464F1DC48CA56...| 3/5/20 6:15|      57|Incoming call|     10212|DE9780FC7BD8DF0F5...|   1021|2020-03-05 06:15:00|2020-03-05|2020-03-05 06:15:57|\n|09D7B89E5590E2576...|F475AA91F486EA5CD...| 3/5/20 7:15|       0| Incoming SMS|     10261|09D7B89E5590E2576...|   1026|2020-03-05 07:15:00|2020-03-05|2020-03-05 07:15:00|\n|A43CF21B5F99731F2...|BB7B2AB9EB330C1EB...| 3/5/20 8:15|      63|Outgoing call|     20358|A43CF21B5F99731F2...|   2035|2020-03-05 08:15:00|2020-03-05|2020-03-05 08:16:03|\n|255AD6FD7E2001125...|5CCE981FAA2A4150B...| 3/5/20 9:15|      24|Incoming call|     20364|255AD6FD7E2001125...|   2036|2020-03-05 09:15:00|2020-03-05|2020-03-05 09:15:24|\n|DCCB83A592032E252...|08F092D5F3DCE7E54...|3/5/20 10:15|      61|Outgoing call|     20151|DCCB83A592032E252...|   2015|2020-03-05 10:15:00|2020-03-05|2020-03-05 10:16:01|\n|CD95FCA06EAB79DDE...|6F67A423DFBED461C...|3/5/20 11:15|       1|Outgoing call|     20151|CD95FCA06EAB79DDE...|   2015|2020-03-05 11:15:00|2020-03-05|2020-03-05 11:15:01|\n|CD95FCA06EAB79DDE...|C97E3373F4FCAE951...|3/5/20 12:15|      52|Incoming call|     36056|CD95FCA06EAB79DDE...|   3605|2020-03-05 12:15:00|2020-03-05|2020-03-05 12:15:52|\n|B862EE3D2E3116313...|12D44BBA7C601F8EF...|3/5/20 13:15|       0| Incoming SMS|     36056|B862EE3D2E3116313...|   3605|2020-03-05 13:15:00|2020-03-05|2020-03-05 13:15:00|\n|DD8FBDA5A3514235E...|AC30D97C9C2131D1C...|3/5/20 14:15|       0| Incoming SMS|     34607|DD8FBDA5A3514235E...|   3460|2020-03-05 14:15:00|2020-03-05|2020-03-05 14:15:00|\n|C3D81710BA15B496C...|80FE622150D7A73D6...|3/5/20 15:15|     156|Incoming call|     34605|C3D81710BA15B496C...|   3460|2020-03-05 15:15:00|2020-03-05|2020-03-05 15:17:36|\n|09A77B4A47392F1ED...|2C0EAB16D40BEC95D...|3/5/20 16:15|      44|Incoming call|     20357|09A77B4A47392F1ED...|   2035|2020-03-05 16:15:00|2020-03-05|2020-03-05 16:15:44|\n|120C6EB13C98E4A4E...|AAC86FE84600BAAE1...|3/5/20 17:15|       4|Outgoing call|     20357|120C6EB13C98E4A4E...|   2035|2020-03-05 17:15:00|2020-03-05|2020-03-05 17:15:04|\n|9909348E58D954C71...|0C69C8909C9FB1E15...|3/5/20 18:15|       9|Outgoing call|     10212|9909348E58D954C71...|   1021|2020-03-05 18:15:00|2020-03-05|2020-03-05 18:15:09|\n|5540EDDBBD19DF48F...|4F753F20CC76DE33D...|3/5/20 19:15|      33|Outgoing call|     10212|5540EDDBBD19DF48F...|   1021|2020-03-05 19:15:00|2020-03-05|2020-03-05 19:15:33|\n+--------------------+--------------------+------------+--------+-------------+----------+--------------------+-------+-------------------+----------+-------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1611185052892_1899281183","id":"20210120-203500_1680280468","dateCreated":"2021-01-20T23:24:12+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69"},{"text":"%spark.pyspark\ncells.show()","user":"innocent","dateUpdated":"2021-01-20T23:24:12+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+--------------------+-------+--------------------+-----------+--------+---------+----------+----------+----------+----------+----------+----------+-------------+-------------+----------+--------+-------+------+----------+--------+-------+-------+--------+\n|_c0|                Name|site_id|            geometry|index_right|OBJECTID| locality|SUM_Final_|SUM_Final1|SUM_Fina_1|SUM_Fina_2|SUM_Fina_3|SUM_Fina_4|   Shape_Leng|   Shape_Area|Population|Prim Sch|Sec Sch|Health|Func Water|Non-Func|Schools|Jun Sec|Pre-Prim|\n+---+--------------------+-------+--------------------+-----------+--------+---------+----------+----------+----------+----------+----------+----------+-------------+-------------+----------+--------+-------+------+----------+--------+-------+-------+--------+\n|  0|              SULIMA|   2082|POINT (-11.57535 ...|         12|      13|  Pujehun|  168869.0|  177592.0|  346461.0|       0.0|       0.0|       0.0|3.51945525566|0.34222945521|    346461|     108|      8|   110|       847|     264|    339|     24|    17.0|\n|  1|              MALEMA|   2080|POINT (-11.38846 ...|         12|      13|  Pujehun|  168869.0|  177592.0|  346461.0|       0.0|       0.0|       0.0|3.51945525566|0.34222945521|    346461|     108|      8|   110|       847|     264|    339|     24|    17.0|\n|  2|     MALEMA_REPEATER|   2081|POINT (-11.37431 ...|         12|      13|  Pujehun|  168869.0|  177592.0|  346461.0|       0.0|       0.0|       0.0|3.51945525566|0.34222945521|    346461|     108|      8|   110|       847|     264|    339|     24|    17.0|\n|  3|            ZIMMI_II|   2238|POINT (-11.306095...|         12|      13|  Pujehun|  168869.0|  177592.0|  346461.0|       0.0|       0.0|       0.0|3.51945525566|0.34222945521|    346461|     108|      8|   110|       847|     264|    339|     24|    17.0|\n|  4|            GBUNDAPI|   2070|POINT (-11.84826 ...|         12|      13|  Pujehun|  168869.0|  177592.0|  346461.0|       0.0|       0.0|       0.0|3.51945525566|0.34222945521|    346461|     108|      8|   110|       847|     264|    339|     24|    17.0|\n|  5|          PUJEHUN_II|   4033|POINT (-11.717965...|         12|      13|  Pujehun|  168869.0|  177592.0|  346461.0|       0.0|       0.0|       0.0|3.51945525566|0.34222945521|    346461|     108|      8|   110|       847|     264|    339|     24|    17.0|\n|  6|          PUJEHUN_II|   2233|POINT (-11.717965...|         12|      13|  Pujehun|  168869.0|  177592.0|  346461.0|       0.0|       0.0|       0.0|3.51945525566|0.34222945521|    346461|     108|      8|   110|       847|     264|    339|     24|    17.0|\n|  7|              FOINDU|   2263|POINT (-11.538847...|         12|      13|  Pujehun|  168869.0|  177592.0|  346461.0|       0.0|       0.0|       0.0|3.51945525566|0.34222945521|    346461|     108|      8|   110|       847|     264|    339|     24|    17.0|\n|  8|              SOCFIN|   4041|POINT (-11.841467...|         12|      13|  Pujehun|  168869.0|  177592.0|  346461.0|       0.0|       0.0|       0.0|3.51945525566|0.34222945521|    346461|     108|      8|   110|       847|     264|    339|     24|    17.0|\n|  9|              SOCFIN|   2248|POINT (-11.841467...|         12|      13|  Pujehun|  168869.0|  177592.0|  346461.0|       0.0|       0.0|       0.0|3.51945525566|0.34222945521|    346461|     108|      8|   110|       847|     264|    339|     24|    17.0|\n| 10|           POTORU_II|   2237|POINT (-11.477825...|         12|      13|  Pujehun|  168869.0|  177592.0|  346461.0|       0.0|       0.0|       0.0|3.51945525566|0.34222945521|    346461|     108|      8|   110|       847|     264|    339|     24|    17.0|\n| 11|            SANMALIN|   2029|POINT (-11.805204...|         12|      13|  Pujehun|  168869.0|  177592.0|  346461.0|       0.0|       0.0|       0.0|3.51945525566|0.34222945521|    346461|     108|      8|   110|       847|     264|    339|     24|    17.0|\n| 12|       BANDAJUMASEWA|   2236|POINT (-11.6572 7...|         12|      13|  Pujehun|  168869.0|  177592.0|  346461.0|       0.0|       0.0|       0.0|3.51945525566|0.34222945521|    346461|     108|      8|   110|       847|     264|    339|     24|    17.0|\n| 13|3G_SOCFIN-RESIDEN...|   4090|POINT (-11.87555 ...|         12|      13|  Pujehun|  168869.0|  177592.0|  346461.0|       0.0|       0.0|       0.0|3.51945525566|0.34222945521|    346461|     108|      8|   110|       847|     264|    339|     24|    17.0|\n| 14|               SONGO|   3552|POINT (-12.9448 8...|         11|      12|Port Loko|  255030.0|  275835.0|  530865.0|       0.0|       0.0|       0.0|5.61509907028|0.38435874897|    615376|     242|     42|    97|      1975|     517|    773|    153|    41.0|\n| 15|               SONGO|   1200|POINT (-12.9448 8...|         11|      12|Port Loko|  255030.0|  275835.0|  530865.0|       0.0|       0.0|       0.0|5.61509907028|0.38435874897|    615376|     242|     42|    97|      1975|     517|    773|    153|    41.0|\n| 16|            OKRAHILL|   3580|POINT (-12.826463...|         11|      12|Port Loko|  255030.0|  275835.0|  530865.0|       0.0|       0.0|       0.0|5.61509907028|0.38435874897|    615376|     242|     42|    97|      1975|     517|    773|    153|    41.0|\n| 17|            OKRAHILL|   1031|POINT (-12.826463...|         11|      12|Port Loko|  255030.0|  275835.0|  530865.0|       0.0|       0.0|       0.0|5.61509907028|0.38435874897|    615376|     242|     42|    97|      1975|     517|    773|    153|    41.0|\n| 18|             MASAIKA|   4053|POINT (-12.75656 ...|         11|      12|Port Loko|  255030.0|  275835.0|  530865.0|       0.0|       0.0|       0.0|5.61509907028|0.38435874897|    615376|     242|     42|    97|      1975|     517|    773|    153|    41.0|\n| 19|             MASAIKA|   2039|POINT (-12.75656 ...|         11|      12|Port Loko|  255030.0|  275835.0|  530865.0|       0.0|       0.0|       0.0|5.61509907028|0.38435874897|    615376|     242|     42|    97|      1975|     517|    773|    153|    41.0|\n+---+--------------------+-------+--------------------+-----------+--------+---------+----------+----------+----------+----------+----------+----------+-------------+-------------+----------+--------+-------+------+----------+--------+-------+-------+--------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1611185052892_-718436269","id":"20210120-194239_1997927342","dateCreated":"2021-01-20T23:24:12+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:70"},{"text":"%spark.pyspark\n","user":"innocent","dateUpdated":"2021-01-20T23:24:12+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611185052893_-339828656","id":"20210120-203642_1123090318","dateCreated":"2021-01-20T23:24:12+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:71"}],"name":"Training/2.Creating-Temporary-Views","id":"2FXH76KXV","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}